!function(){"use strict";function a(a){var b={},c={};b.height=window.innerHeight-100,b.width=window.innerWidth-100,c.height=a.height,c.width=a.width;var d=+(b.width/c.width).toFixed(2),e=+(b.height/c.height).toFixed(2),f=b.width>=c.width?b.height>=c.height?1:e:b.height>=c.height||b.height>=d*c.height?d:e;return 1!==f||document.querySelector(".save-checkbox-row").classList.contains("hidden")||document.querySelector(".save-checkbox-row").classList.add("hidden"),1>f&&document.querySelector(".save-checkbox-row").classList.contains("hidden")&&document.querySelector(".save-checkbox-row").classList.remove("hidden"),{pct:f,height:c.height*f,width:c.width*f}}function b(){var a=document.createElement("div");a.classList.add("load-msg"),a.innerText="image loaded",document.querySelector(".mirrors").classList.contains("img-loaded")&&document.querySelector(".mirrors").classList.remove("img-loaded"),document.getElementById("urlfield").removeEventListener("change",e),document.getElementById("fileupload").removeEventListener("change",e),document.getElementById("demo").removeEventListener("click",e),document.querySelector(".mirror-controller-panel").insertBefore(a,document.querySelector(".mirrors")),setTimeout(function(){document.querySelector(".mirror-controller-panel").removeChild(document.querySelector(".load-msg")),document.getElementById("urlfield").addEventListener("change",e),document.getElementById("fileupload").addEventListener("change",e),document.getElementById("demo").addEventListener("click",e),document.querySelector(".mirrors").classList.add("img-loaded")},2e3)}function c(c){var d=null===document.getElementById("canvas")?document.createElement("canvas"):document.getElementById("canvas");return k=new Image,k.setAttribute("crossOrigin","anonymous"),d.hasAttribute("data-filled")&&(d.removeAttribute("data-filled"),document.querySelector(".save-options").classList.remove("active-image")),d.hasAttribute("data-mtype")&&d.removeAttribute("data-mtype"),k.src=c,d.id="canvas",d.classList.add(d.id),k.onload=function(){b(),0===document.getElementById("canvas-wrapper").children.length&&document.getElementById("canvas-wrapper").appendChild(d),null!==document.querySelector(".active")&&document.querySelector(".active").classList.remove("active");var c=a(k);return d.setAttribute("data-pct",c.pct),d.height=c.height,d.width=c.width,k},k}function d(a){var b=document.createElement("canvas");return b.id="simcanvas",b.classList.add(b.id),b.width=a.width,b.height=a.height,b.setAttribute("data-mtype",document.getElementById("canvas").getAttribute("data-mtype")),document.getElementById("canvas-wrapper").appendChild(b),b}function e(a){if("urlfield"===a.target.id){var b=new RegExp(/^http(s)?:\/\/.+((\.)(bmp|svg|jpg|gif|png))$/);b.test(a.target.value)===!0?k=c(a.target.value):alert("Please enter a valid image URL.")}if("fileupload"===a.target.id){var d=document.getElementById("fileupload"),e=d.files[0],f=new FileReader;f.addEventListener("load",function(a){var b=f.result;k=c(b)},!1),e&&f.readAsDataURL(e)}"demo"===a.target.id&&(k=c("./assets/2.jpg"))}function f(a,b){var c=b?document.getElementById("simcanvas"):document.getElementById("canvas"),d=c.getContext("2d"),e={tWidth:k.width,tHeight:k.height,hHeight:k.height/2,hWidth:k.width/2},f={tWidth:c.width,tHeight:c.height,hHeight:c.height/2,hWidth:c.width/2};switch(c.hasAttribute("data-filled")?d.clearRect(0,0,f.tWidth,f.tHeight):(c.setAttribute("data-filled",!0),document.querySelector(".save-options").classList.add("active-image")),a){case"left":c.setAttribute("data-mtype","left"),d.drawImage(k,0,0,e.hWidth,e.tHeight,0,0,f.hWidth,f.tHeight),d.save(),d.scale(-1,1),d.drawImage(k,0,0,e.hWidth,e.tHeight,-f.tWidth,0,f.hWidth,f.tHeight),d.scale(1,1),d.restore();break;case"right":c.setAttribute("data-mtype","right"),d.drawImage(k,e.hWidth,0,e.hWidth,e.tHeight,f.hWidth,0,f.hWidth,f.tHeight),d.save(),d.scale(-1,1),d.drawImage(k,e.hWidth,0,e.tWidth,e.tHeight,-f.hWidth,0,f.tWidth,f.tHeight),d.restore();break;case"top":c.setAttribute("data-mtype","top"),d.drawImage(k,0,0,e.tWidth,e.hHeight,0,0,f.tWidth,f.hHeight),d.save(),d.scale(1,-1),d.drawImage(k,0,0,e.tWidth,e.hHeight,0,-f.hHeight,f.tWidth,-f.hHeight),d.restore();break;case"bottom":c.setAttribute("data-mtype","bottom"),d.drawImage(k,0,e.hHeight,e.tWidth,e.tHeight,0,f.hHeight,f.tWidth,f.tHeight),d.save(),d.scale(1,-1),d.drawImage(k,0,e.hHeight,e.tWidth,e.tHeight,0,-f.hHeight,f.tWidth,f.tHeight),d.restore();break;case"top left":c.setAttribute("data-mtype","top left"),d.drawImage(k,0,0,e.hWidth,e.hHeight,0,0,f.hWidth,f.hHeight),d.save(),d.scale(-1,1),d.drawImage(k,0,0,e.hWidth,e.hHeight,-f.tWidth,0,f.hWidth,f.hHeight),d.scale(1,-1),d.drawImage(k,0,0,e.hWidth,e.hHeight,-f.tWidth,-f.hHeight,f.hWidth,-f.hHeight),d.scale(-1,1),d.drawImage(k,0,0,e.hWidth,e.hHeight,0,-f.hHeight,f.hWidth,-f.hHeight),d.restore();break;case"top right":c.setAttribute("data-mtype","top right"),d.drawImage(k,e.hWidth,0,e.tWidth,e.hHeight,f.hWidth,0,f.tWidth,f.hHeight),d.save(),d.scale(-1,1),d.drawImage(k,e.hWidth,0,e.tWidth,e.hHeight,-f.hWidth,0,f.tWidth,f.hHeight),d.scale(1,-1),d.drawImage(k,e.hWidth,0,e.tWidth,e.hHeight,f.hWidth,-f.hHeight,-f.tWidth,-f.hHeight),d.scale(-1,1),d.drawImage(k,e.hWidth,0,e.tWidth,e.hHeight,f.hWidth,-f.hHeight,f.tWidth,-f.hHeight),d.restore();break;case"bottom left":c.setAttribute("data-mtype","bottom left"),d.drawImage(k,0,e.hHeight,e.hWidth,e.tHeight,0,f.hHeight,f.hWidth,f.tHeight),d.save(),d.scale(-1,1),d.drawImage(k,0,e.hHeight,e.hWidth,e.tHeight,-f.hWidth,f.hHeight,-f.hWidth,f.tHeight),d.scale(1,-1),d.drawImage(k,0,e.hHeight,e.hWidth,e.tHeight,-f.hWidth,-f.hHeight,-f.hWidth,f.tHeight),d.scale(-1,1),d.drawImage(k,0,e.hHeight,e.hWidth,e.tHeight,0,-f.hHeight,f.hWidth,f.tHeight),d.restore();break;case"bottom right":c.setAttribute("data-mtype","bottom right"),d.drawImage(k,e.hWidth,e.hHeight,e.tWidth,e.tHeight,f.hWidth,f.hHeight,f.tWidth,f.tHeight),d.save(),d.scale(-1,1),d.drawImage(k,e.hWidth,e.hHeight,e.tWidth,e.tHeight,f.hWidth,f.hHeight,-f.tWidth,f.tHeight),d.scale(1,-1),d.drawImage(k,e.hWidth,e.hHeight,e.tWidth,e.tHeight,f.hWidth,f.hHeight,-f.tWidth,-f.tHeight),d.scale(-1,1),d.drawImage(k,e.hWidth,e.hHeight,e.tWidth,e.tHeight,f.hWidth,f.hHeight,f.tWidth,-f.tHeight),d.restore()}}function g(a){return void 0===k?!1:(null!==document.querySelector(".active")&&document.querySelector(".active").classList.remove("active"),a.target.classList.add("active"),void f(a.target.innerText.toLowerCase().replace(/\n/," "),!1))}function h(){if(null!==document.getElementById("canvas")&&document.getElementById("canvas").hasAttribute("data-mtype")){var b=a(k);canvas.setAttribute("data-pct",b.pct),canvas.height=b.height,canvas.width=b.width,f(document.getElementById("canvas").getAttribute("data-mtype"),!1)}}function i(a){var b=document.getElementById("canvas"),c=b.getAttribute("data-pct")<1?document.getElementById("preserve").checked:null,e="svg"===e?a.target.value+"+xml":a.target.value;c===!0&&(b=d(k),f(b.getAttribute("data-mtype"),!0));var g=b.toDataURL("image/"+e);window.open(g),"simcanvas"===b.id&&document.getElementById("canvas-wrapper").removeChild(b)}function j(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}var k;window.addEventListener("resize",j(function(){h()},250)),document.getElementById("urlfield").addEventListener("change",e),document.getElementById("fileupload").addEventListener("change",e),document.getElementById("demo").addEventListener("click",e);for(var l=0;l<document.querySelectorAll(".savebtn").length;l++)document.querySelectorAll(".savebtn")[l].addEventListener("click",i);for(var m=0;m<document.querySelectorAll(".mirrors button").length;m++)document.querySelectorAll(".mirror-block-btn")[m].addEventListener("click",g)}();